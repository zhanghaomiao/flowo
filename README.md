# Flowo üöÄ

Welcome to **Flowo** ‚Äì your real-time Snakemake workflow dashboard!

Unleash the power of automation and monitoring with a fresh, interactive experience.

**Demo page: [flowo online](https://zhanghaomiao.github.io/flowo)**

---

## ‚ú® Features

- ‚ö° **Real-time Monitoring:**
  Flowo leverages Server-Sent Events (SSE) and PostgreSQL's LISTEN/NOTIFY mechanism for instant workflow updates. The frontend refreshes automatically ‚Äì just sit back and watch the magic happen!

- üöÄ **Efficient Data Fetching:**
  With smart polling (every 5 seconds) and debouncing, Flowo keeps your data up-to-date without overloading the network. Fast, efficient, and always fresh.

- üîç **Search & Filtering:**
  Instantly find workflows by name, tags, or user. Delete workflows from the database with a click (no worries, your files are safe).

- üß© **Rule-based Filtering:**
  Focus on specific rules to filter jobs and update the execution timeline. Debug and optimize like a pro!

- üñºÔ∏è **Result Preview:**
  Instantly preview output files generated by your favorite rules, right in the Results submenu. No more hunting for results!

- üìã **Logging System:**
  Dive into detailed workflow and job logs. Analyze, learn, and improve your processes with ease.

---

### üõ†Ô∏è Workflows

![Workflow](assets/images/workflow.png)

### üìä Dashboard

![Dashboard](assets/images/dashboard.png)

### üïπÔ∏è Jobs

| ![DAG](assets/images/dag.png) | ![Jobs](assets/images/jobs.png) |
| ----------------------------- | ------------------------------- |

---

## üö¶ Installation

- **Requirements:**
  - üêß Linux system
  - üê≥ Docker
  - üêç snakemake >= 9.6.2

Flowo consists of two parts:

- The Flowo web service (this repository)
- The Snakemake plugin: [snakemake-logger-plugin-flowo](https://github.com/jmzhang1911/snakemake-logger-plugin-flowo)

---

### 1Ô∏è‚É£ Install the Flowo Web Service

```sh
git clone https://github.com/zhanghaomiao/flowo.git
cd flowo
cp env.example .env
```

2. **Build and Run Backend**:

```sh
docker compose up -d --build
```

Edit your `.env` file as follows. In most cases, you only need to modify ‚ö†Ô∏è `FLOWO_WORKING_PATH` to point to the directory where you run your Snakemake workflows:

```sh
# Application Settings
DOMAIN=localhost
PORT=3100
TZ=Asia/Shanghai

# Database Configuration
POSTGRES_DB=flowo_logs
POSTGRES_USER=flowo
POSTGRES_PASSWORD=flowo_password
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Workflow Directory
FLOWO_WORKING_PATH=/path/to/flowo_project_dir  # ‚ö†Ô∏è Important: set this to your workflow directory
```

Start the Flowo web service:

```sh
docker compose -f docker-compose.yml up -d
```

Open [http://localhost:3100](http://localhost:3100) in your browser.
If you see the Flowo interface and the "Live Updates" icon is green, congratulations‚Äîyour Flowo web service is running successfully! üéâ

---

### 2Ô∏è‚É£ Install the Snakemake Logger Plugin

Next, let's install the Snakemake plugin.
For detailed installation, configuration, and usage, please refer to the plugin's [documentation](https://github.com/jmzhang1911/snakemake-logger-plugin-flowo).

Quick start:

```sh
pip install .  # Install the plugin from the root of this repo
flowo-init-config --generate-config
```

Configure the plugin:

```sh
vim $HOME/.config/flowo/.env
```

Edit your `$HOME/.config/flowo/.env` as follows:

```sh
### Postgres settings
POSTGRES_USER=flowo         # same as your .env
POSTGRES_PASSWORD=flowo_password  # same as your .env
POSTGRES_DB=flowo_logs      # same as your .env
POSTGRES_HOST=localhost     # same as your .env
POSTGRES_PORT=5432          # same as your .env

### APP settings
# FLOWO_USER has been removed.
# Authentication is handled via FLOWO_USER_TOKEN.
FLOWO_USER_TOKEN=your_generated_token_here
FLOWO_WORKING_PATH=/path/to/flowo_project_dir # ‚ö†Ô∏è same as your .env
```

### üì¶ Docker Environments

We provide two ways to run Flowo using Docker:

1. **Production Mode (`docker-compose.yml`)**:
   Uses pre-built images from GitHub Container Registry (GHCR). Ideal for deployment.

   ```sh
   docker compose pull
   docker compose up -d
   ```

2. **Development Mode (`docker-compose.dev.yml`)**:
   Builds images from your local source code. Ideal for testing changes.
   ```sh
   docker compose -f docker-compose.dev.yml up --build
   ```

### üè∑Ô∏è Versioning & Releases

Versioning is handled automatically through GitHub Actions.

#### Automating Version Bumps

To increment the project version:

1. Go to the **Actions** tab in your GitHub repository.
2. Select the **"Bump Version"** workflow.
3. Click **"Run workflow"**, choose the bump type (`patch`, `minor`, or `major`), and run.
4. This will update `pyproject.toml` and commit the change automatically.

#### Creating Releases

Whenever you push to the `release` branch, a new GitHub Release is created, and Docker images are pushed to GHCR with the version tag.

---

## üöÄ Usage

All set! üéâ
Let's test with a demo project:

```sh
cd /path/to/flowo_project_dir
mkdir demo                # Create a demo project folder
cd demo
wget https://raw.githubusercontent.com/zhanghaomiao/flowo/refs/heads/main/tests/demos/Snakefile
# Run snakemake with flowo logger
snakemake \
    --logger flowo \
    --logger-flowo-name=your_project_name \
    --logger-flowo-tags="tagA,tagB,tagC"
```

Now, check out your workflow in the Flowo web! Good luck! üçÄ
